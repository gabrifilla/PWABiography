<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>API - MARVEL</title>
  <!-- CSS only -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- JavaScript Bundle with Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"></script>
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/core.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/md5.js"></script>
  <script>
    $(document).ready(function () {
      $("#pesquisa").click(function () {
        var publicKey = "8f4cc787a1653cab670c4231170dca1e";
        var privateKey = "3bd9677e9831ed694c0200f2fc75fd68b797508a";
        var ts = Date.now();
        var hash = CryptoJS.MD5(ts + privateKey + publicKey);
        var name = $("#name").val();
        var url = "http://gateway.marvel.com/v1/public/characters?name=" + name + "&ts=" + ts + "&apikey=" + publicKey + "&hash=" + hash;
        //{url: url, type: "GET", datatype: "json"}
        $.ajax({
          url: url,
          type: "GET",
          dataType: "json",
          success: function (data) {
            console.log(data);
            if(data['data']['total'] == 0){
              $('.personagem').empty();
              var html = '<h3>Personagem 404!</h3>';
              $('.personagem').append(html);
            }else{
              $('.personagem').empty();
              var html = '<img style="width:200px;" src="' + data['data']['results'][0]['thumbnail']['path'] + '.' + data['data']['results'][0]['thumbnail']['extension'] + '"><br><p>' + data['data']['results'][0]['name'] + '</p>';
              $('.personagem').append(html);
            }
          }
        });
      });
    });
  </script>
</head>
<body>
  <div class="container">
    <h1>ESCOLHA SEU PERSOGEM</h1>
    <div class="row">
      <div class="col-4">
        <label class="visually-hidden" for="inlineFormInputGroupUsername">Personagem</label>
        <div class="input-group">
          <div class="input-group-text">@</div>
          <input type="text" class="form-control" id="name" name="name" placeholder="Personagem">
        </div>
      </div>
      <div class="col-4">
        <button class="btn btn-primary" id='pesquisa'>Pesquisar</button>
      </div>
    </div>
    <hr>
    <div class="personagem"></div>
  </div>

</body>

</html>
